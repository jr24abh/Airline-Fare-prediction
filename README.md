# Optimizing Airline Fare Prediction Using Ensemble Machine Learning Models

**Student Name:** Rerai John Kihanya
**SRN:** 23100389
**Supervisor:** Carolyn Devereux
**University of Hertfordshire**

This project was developed in **Google Colab** to predict U.S. domestic airline fares with high accuracy by leveraging and comparing advanced machine learning techniques, including Random Forest, XGBoost, CatBoost, and Neural Networks.

## Overview

Airfare pricing is a dynamic and complex process influenced by various market and operational factors. This project aims to solve the challenge of predicting flight cost fluctuations for consumers and industry stakeholders. After implementing a rigorous methodology to prevent data leakage, the final **Random Forest model achieved an exceptional R² score of 0.994** on the test set, demonstrating the power of ensemble methods on structured tabular data.

## Key Features

- **Data Source:** U.S. Bureau of Transportation Statistics (BTS) dataset (`MarketFarePredictionData.csv`).
- **Development Environment:** Google Colab (Python 3.x, GPU runtime).
- **Algorithms Compared:** Random Forest, XGBoost, CatBoost, Neural Network (MLP).
- **Advanced Feature Engineering:** Created features like `CarrierShare` and `IsLCC` while rigorously avoiding data leakage (excluding target-derived features from training).
- **Comprehensive Evaluation:** Models assessed using RMSE, R², MAE, MAPE, and inference time.
- **Key Findings:** Route distance (`NonStopMiles`, `MktMilesFlown`) and market concentration (`Market_HHI`) were the most significant predictors.

## How to Run This Project

*This project is contained within a single Google Colab notebook. All code is ready to run in that environment.*

1.  **Access the Notebook:**
    *   The main project notebook can be accessed here: **[Open the Google Colab Notebook](https://colab.research.google.com/drive/1H5WyJCkmLO0fstyzWhJ4jI_eCeEOPLr8?usp=sharing)**

2.  **Prepare the Data (First-Time Setup):**
    *   The code is designed to read the dataset from Google Drive.
    *   Upload the `MarketFarePredictionData.csv` file to a folder called `Datasets` in your Google Drive's root directory (`MyDrive/Datasets/`).
    *   *Alternatively*, the notebook contains code to use Colab's built-in file uploader when you run the cell.

3.  **Run the Notebook:**
    *   Open the Colab notebook using the link above.
    *   The easiest way to run everything is to click `Runtime` in the menu bar and select `Run all`.
    *   This will:
        - Mount your Google Drive.
        - Install necessary dependencies (`catboost`, `xgboost`, etc.).
        - Load and preprocess the data.
        - Perform Exploratory Data Analysis (EDA) and generate visualizations.
        - Train, tune, and evaluate all four machine learning models.
        - Save output figures and the final model.

## Results

The tuned Random Forest Regressor was the clear outperformer. Below are the results on the held-out test set:

| Model | RMSE (USD) | R² Score | MAE (USD) | MAPE (%) |
| :--- | :--- | :--- | :--- | :--- |
| **Random Forest** | **5.71** | **0.994** | **4.21** | **2.01** |
| XGBoost | 20.57 | 0.920 | 14.23 | 6.82 |
| CatBoost | 21.15 | 0.915 | 14.59 | 6.98 |
| Neural Network (MLP) | 31.71 | 0.809 | 21.12 | 10.12 |
| *Baseline (Static Features)* | *19.19* | *0.930* | *13.32* | *6.38* |

**Key Visualizations (Generated by the code):**
*   `correlation_heatmap_annotated.png` - Shows relationships between numerical features.
*   `feature_importance_clean.png` - Highlights the top predictors (NonStopMiles, Market_HHI).
*   `model_comparison.png` - Bar chart comparing R² and RMSE of all models.
*   `residual_plot_enhanced.png` - Diagnoses the Random Forest model's performance.

## Conclusion

The project successfully demonstrated that ensemble methods, particularly Random Forest, are highly effective for the airline fare prediction problem on this dataset. The model's exceptional accuracy (R²=0.994) and computational efficiency (~0.033 ms per prediction) make it a prime candidate for deployment in real-world applications such as consumer fare prediction tools.

## Future Work

- **Incorporate Real-Time Data:** Integrate live APIs for fuel prices, demand indicators, and events to combat concept drift.
- **Application Development:** Develop a user-facing web or mobile application using a framework like Streamlit.
- **Enhanced Explainability:** Integrate tools like SHAP (SHapley Additive exPlanations) to provide users with reasons behind each prediction.
- **Explore Advanced Architectures:** Experiment with hybrid models or neural architectures designed for tabular data (e.g., TabNet).

## License

This project was submitted in partial fulfillment of the requirements for the degree of **MSc in Data Science** at the University of Hertfordshire. The code is shared for academic and review purposes.

## Acknowledgments

- Data provided by the [U.S. Bureau of Transportation Statistics (BTS)](https://www.transtats.bts.gov/).
- I extend my deepest appreciation to my supervisor, Dr. Carolyn Devereux, for her invaluable guidance and steadfast support.
- Built with Python libraries including Pandas, Scikit-learn, XGBoost, CatBoost, TensorFlow/Keras, and Matplotlib/Seaborn.
